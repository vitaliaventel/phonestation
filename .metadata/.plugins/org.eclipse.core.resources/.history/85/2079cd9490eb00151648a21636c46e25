package finalproject.inface;

import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.*;
import javax.swing.*;

public class RequestsDialog extends JDialog {

	private JTextArea reqArea;

	public RequestsDialog(JFrame frame) {
		super(frame, "Pending requests..", true);
		reqArea = new JTextArea();
		reqArea.setEditable(false);
		reqArea.setLineWrap(true);
		reqArea.setText("You need to update subscribers requests, press *Update*.");

		JButton update = new JButton("Update");

		JButton clear = new JButton("Clear");
		JPanel panel = new JPanel();
		panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS));
		panel.add(update);
		panel.add(clear);
		add(panel, BorderLayout.WEST);
		add(new JScrollPane(reqArea), BorderLayout.CENTER);
		setSize(700, 400);
		setResizable(false);
		setLocationRelativeTo(null);
		setVisible(true);

		RequestDialogListener rdl = new RequestDialogListener();
		update.addActionListener(rdl);
		clear.addActionListener(rdl);
	}

	private class RequestDialogListener implements ActionListener {

		@Override
		public void actionPerformed(ActionEvent ae) {
			JButton src = (JButton) ae.getSource();
			if (src.getText().equals("Update")) {
				try {
					File file = new File("resources", "subrequest_main.txt");
					BufferedReader in = new BufferedReader(new InputStreamReader(new FileInputStream(file)));
					try {
						String s;
						while ((s = in.readLine()) != null) {
							reqArea.append(s + "\n");
						}
					} finally {
						in.close();
					}
				} catch (IOException e) {
					e.printStackTrace();
				}
			} else if (src.getText().equals("Clear")) {
				try {
					File file = new File("resources", "subrequest_main.txt");
					PrintWriter out = new PrintWriter(new BufferedWriter(new FileWriter(file)));
					try {
						out.print("");
					} finally {
						out.close();
					}
				} catch (IOException e) {
					e.printStackTrace();
				}
				reqArea.setText("");
			}

		}

	}
}
